{% extends 'base.html.twig' %}

{% block title %}Hello AdminController!{% endblock %}

{% block body %}


{%  for message in app.flashes('success') %}
		<div class="alert alert-success" role"alert">
			{{ message }}
		</div>
	{% endfor %}
<nav>
<a class="btn btn-primary" href="{{ path('app_admin_newCat')}}">Nouvelle categorie</a>
<a class="btn btn-primary" href="{{ path('app_admin_newProject')}}">Nouveau projet</a>
<a class="btn btn-primary" href="{{ path('app_admin_newService')}}">Nouveau service</a>

</nav>

    <div class="fs-2">Categories</div>
    <table class="table">
    <thead>
    
        <tr>
            <td>Nom Categorie</td>
            <td>Action</td>
        </tr>
    </thead>
    <tbody>
    {% for cat in cats %}
        <tr>
            <td>{{ cat.name }}</td>
            <td>
            <a type="button" class="btn btn-warning" title="Editer" href="{{ path('app_admin_editCat' , {id: cat.id })}}">Editer</a>
					<form
							action="{{ path('app_admin_deleteCat', { id: cat.id } ) }}" method="post" class="d-inline">
							{# csrf_token().. creation d'un jeton unique  #}
							<input type="hidden" name="token" value="{{ csrf_token('delete-project-'~ cat.id) }}">
							<button class="btn btn-sm btn-outline-danger">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewbox="0 0 16 16">
									<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
									<path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
								</svg>
							</button>
						</form>	
            </td>
        </tr>
        {% endfor %}
    </tbody>
    
    </table>

     {{ knp_pagination_render(cats) }}
    <div class="fs-2">projets</div>
	<table class="table">
		<thead>
			<tr>
				<td>Titre</td>
				<td>Description</td>
				<td>Ville</td>
				<td>Créer le</td>
				<td>Image</td>
				<td>Action</td>

			</tr>
		</thead>
		<tbody>
			{% for project in projects %}
				<tr>

					<td>{{ project.title }}</td>
					<td>{{ project.Description | u.truncate(20,'...') }}</td>
					<td>{{ project.city }}</td>
					<td>{{ project.createdAt | date('d-m-Y') }}</td>
					<td>
						{% if vich_uploader_asset(project,'coverFile') %}
							<img src="{{ vich_uploader_asset(project,'coverFile')|imagine_filter('thumbnail') }}" id="object-position-1" alt="image d'un projet">
						{% endif %}
					</td>
					<td>
						<a type="button" class="btn btn-warning" title="Editer" href="{{ path('app_admin_editProject' , {id: project.id })}}">Editer</a>
						{# Formulaire securisé de suppresion #}
						<form
							action="{{ path('app_admin_deleteProject', { id: project.id } ) }}" method="post" class="d-inline">
							{# csrf_token().. creation d'un jeton unique  #}
							<input type="hidden" name="token" value="{{ csrf_token('delete-project-'~ project.id) }}">
							<button class="btn btn-sm btn-outline-danger">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash" viewbox="0 0 16 16">
									<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
									<path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
								</svg>
							</button>
						</form>
					</td>

				</tr>
			{% endfor %}
		</tbody>
	</table>

	{{ knp_pagination_render(projects) }}


<h2>Table Services</h2>
<table class="table">
		<thead>
			<tr>
				<td>name</td>
				
			</tr>
		</thead><tbody>
		{% for service in services %}
				<tr>
				<td>{{ service.name }}</td>
				</tr>
				{% endfor %}
		
		</tbody>
</table>

{% endblock %}
